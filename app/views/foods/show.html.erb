<!-- パンくずリスト -->
<% breadcrumb :food_show, @food %>

<div class="container my-5">

  <!-- タイトル -->
  <div class="text-center">
    <h1><%= I18n.t("show.title", food_name: @food.name) %></h1>
  </div>

  <!-- 食品詳細 -->
  <div class="show-food-form">
    <div class="row m-5">
      <!-- 食品画像 -->
      <div class="col-6">
        <%= image_tag(@food.food_image.present? ? @food.food_image.url : "image_ramen.png", class: "img-fluid show-food-image") %>
      </div>
      <div class="col-6">
        <!-- 食品名 -->
        <h2 class="fw-bold text-primary"><%= @food.name %></h2>
        <!-- 食品タグ -->
        <h5 class="fw-bold mt-3">
          <span class="badge rounded-pill bg-danger"><%= @food.food_category.name %></span>
        </h5>
        <!-- 辛さレベル -->
        <h6 class="fw-bold mt-3">
          <%=  I18n.t("activerecord.attributes.review.spice_level") %>
          <% @food.spice_level.times do %>
            <i class="bi bi-fire text-danger"></i>
          <% end %>
          <% (5 - @food.spice_level).times do %>
            <i class="bi bi-fire text-secondary"></i>
          <% end %>
        </h6>
        <!-- 希望小売価格 -->
        <h6 class="fw-bold">
          <%=  I18n.t("activerecord.attributes.food.price") %>
          <% if @food.price != 0 %>
            <%= number_to_currency(@food.price, unit: I18n.t("index.en"), format: "%n %u", precision: 0) %><%= I18n.t("index.in_price") %>
          <% else %>
            <%= I18n.t("index.open_price") %>
          <% end %>
        </h6>
        <!-- タイトル -->
        <p class="text-danger fw-bold mt-3"><%= @food.title %></p>
        <!-- 説明 -->
        <p class="fw-bold"><%= @food.body %></p>
      </div>
    </div>
  </div>

  <!-- タイトル -->
  <div id="show-review-title" class="show-review-title">
    <h1><%= I18n.t("show.review", food_name: @food.name) %></h1>
    <% unless @reviews.present? %>
      <h5 class="text-center text-info pt-2">
        <%= I18n.t("show.no_review") %>
      </h5>
    <% end %>
  </div>

  <!-- レビュー一覧 -->
  <% if @reviews.present? %>
    <div class="show-review-form">
      <!-- ページネーション -->
      <div class="mt-4 me-4 text-end text-primary">
        <%= link_to I18n.t("views.pagination.new"), food_path(@food, sort: 'new', anchor: 'show-review-title'), class: "pe-2 text-decoration-none #{'text-decoration-underline' if @current_sort == 'new'}" %>
        <%= link_to I18n.t("views.pagination.old"), food_path(@food, sort: 'old', anchor: 'show-review-title'), class: "text-decoration-none #{'text-decoration-underline' if @current_sort == 'old'}" %>
      </div>

      <!-- レビューカード -->
      <div class="mx-4">
        <div class="row mb-5">
          <% @reviews.each do |review| %>
            <div class="col-4 pt-4 d-flex">
              <%= link_to user_path(review.user), class: "card show-review-card border-primary d-flex flex-row text-decoration-none" do %>
                <div class="card-title d-flex flex-column my-2 mx-4">
                  <!-- ユーザー名 -->
                  <h5 class="card-title fw-bold mt-2 text-primary">
                    <%= review.user.name.truncate(14) %>
                  </h5>
                  <!-- 辛さレベル -->
                  <span class="card-text fw-bold">
                    <%=  I18n.t("activerecord.attributes.review.spice_level") %>
                    <% review.spice_level.times do %>
                        <i class="bi bi-fire text-danger"></i>
                    <% end %>
                    <% (5 - review.spice_level).times do %>
                        <i class="bi bi-fire text-secondary"></i>
                    <% end %>
                  </span>
                  <!-- タイトル -->
                  <span class="card-text fw-bold mt-2">
                    <%= review.title.truncate(14) %>
                  </span>
                  <!-- 評価 -->
                  <span class="card-text fw-bold mt-1">
                    <%= review.rating.truncate(70) %>
                  </span>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>

        <!-- ページネーション -->
        <div class="mt-3">
          <%= paginate @reviews, theme: 'bootstrap-5' %>
        </div>
    </div>
  <% end %>
</div>